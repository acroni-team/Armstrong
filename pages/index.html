<!DOCTYPE html>
<html lang="pt-br" ng-app="app">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title> Acroni </title>
		<link rel="stylesheet" href="../css/style.css">
		<link rel="stylesheet" href="../css/all.css">
		<script type="text/javascript" src="../js/angular.min.js"></script>
		<script type="text/javascript" src="../js/jquery.min.js"></script>
		<script>
			
			
			var app = angular.module('app', []);
			var controllers = {};



			controllers.Busca = function($scope) {
				var comando = "";
				
				// preciso criar uma funcao que mude esse link padrao de acordo com o comando digitado. Não só esse link, mas também o texto do botão tem que mudar de acordo com esse mesmo comando.
				$scope.linkBotao = "LinkPadrao.html";
				
				$scope.comandos = ["Ajuda", "Loja"];
				$scope.exibirComandos = $scope.comandos.join(" e ", "");
				$scope.focused = false;
				$scope.teste = "";
				
				$scope.contemComando = function(){
					$scope.cmdAjuda = function() {
						if($scope.texto.toLowerCase().includes('ajuda') || $scope.texto.toLowerCase().includes('help')){
							comando = "ajuda";
							return true;
						}
						else {
							return false;
						}
					}
					
					$scope.cmdLoja = function() {
						if($scope.texto.toLowerCase().includes('loja') || $scope.texto.toLowerCase().includes('store')){
							comando = "ajuda";
							return true;
						}
						else {
							return false;
						}
					}
					
					$scope.contem = $scope.cmdAjuda() || $scope.cmdLoja();
					return $scope.contem;
				}
				$scope.redirecionar = function() {
					if(comando == "ajuda") {
						$scope.teste = "active";
					}
				}
			}
			
			
			// essa funcao pega O PRÓPRIO NOME e retira o "cmd" pra saber qual é o comando.
//			function cmdIri(){
//  				var fName = arguments.callee.toString();
//				var finaldonome = fName.indexOf("(");
//				var comecodonome = fName.indexOf("cmd");
//				fName = fName.slice(comecodonome, finaldonome);
//				fName = fName.substring(3, fName.length);
//				alert(fName);
//			}
//			cmdIri();

			app.controller(controllers);

			
			
		</script>
	</head>
	<body  ng-controller="Busca">

			<div class="caixa-search" ng-class="{ligado: focused && contemComando()}">
				<input class="texto-search" type="text" placeholder="Pesquisar" spellcheck="false" autocomplete="false" ng-model="texto" ng-focus="focused = true" ng-blur="focused = false">
				<a class="botao-search" href="#">
					<i class="fas fa-search"></i>
				</a>
				<a ng-href="{{linkBotao}}">
					<button id="inputTexto" ng-click="redirecionar()" class="item" ng-class="{aparecendo: focused && contemComando()}"> {{contem}} </button>
				</a>
			</div>

		<p>Comando digitado: {{texto}} </p>
		<p>Comandos disponíveis: {{exibirComandos}} </p>

		<script>
			$(".caixa-search").mouseleave(function(){
				$(".texto-search").blur();
			});
			$(".caixa-search").focus(function(){
				$(".texto-search").focus();
			});
		</script>


	</body>
</html>
